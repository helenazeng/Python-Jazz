import java.io.IOException;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.client.Get;
import org.apache.hadoop.hbase.client.HTable;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.hbase.client.ResultScanner;
import org.apache.hadoop.hbase.client.Scan;
import org.apache.hadoop.hbase.rest.protobuf.generated.ScannerMessage.Scanner;
import org.apache.hadoop.hbase.util.Bytes;
import org.apache.hadoop.hbase.KeyValue; 
// import log, can be deleted
import org.apache.commons.logging.Log; 
import org.apache.commons.logging.LogFactory; 
import java.util.Iterator; 
import java.util.Map;
import java.util.HashMap;
import java.util.Map.Entry;
import java.util.NavigableMap;

//what I want to get:
// curl -XPUT 'http://lppbdsvd043.phx.aexp.com:9200/mkb/m/  == string
// IDs' -d '{"p1t":"test", "p1f":"yes, okay"}'

public class getData {
  public static void main(String[] args) throws IOException {

	  org.apache.hadoop.conf.Configuration config = HBaseConfiguration.create();
	  HTable table = new HTable(config, "mkb");
	  Scan scan = new Scan();
	  scan.setCaching(2);
	  scan.addFamily(Bytes.toBytes("m"));
	  ResultScanner resultScanner = table.getScanner(scan);
	  
	  try {
		  // first for loop, loop through the resultScanner
		  for (Result result = resultScanner.next(); result != null; result = resultScanner.next()) {
			  // get the keys
			  String key = Bytes.toString(result.getRow());
			  Iterator<KeyValue> it = result.list().iterator();
			  
			  String column = "";
			  while (it.hasNext()) {
				  KeyValue kvalue = it.next();
				  
				  column += "\"" + Bytes.toString(kvalue.getQualifier()) + "\":\"" + Bytes.toString(kvalue.getValue()) 
				            + "\",";
				  
			  }
			  column = column.substring(0, column.length() - 1);
			  org.mortbay.log.Log.info("curl -XPUT 'http://lppbdsvd043.phx.aexp.com:9200/mkb/m/"
					  + key + "' -d '{" + column + "}'");
			  
		  }
		  System.out.println();
	  } finally {
		  resultScanner.close();
		  table.close();
	  }
  }
}
